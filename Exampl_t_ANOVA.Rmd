---
title: "Exampl_t_ANOVA.Rmd"
author: "F.A. Barrios"
date: "10/10/2020"
output: html_document
---

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Examples Chap03 

The examples for chapter 3 using data from the heart and estrogen/progestin study (HERS), a clinical trial of hormone therapy (HT) for prevention of recurent heart attacks and death among 2,763 post-menopausal women with existing voronary heart disease (CHD)

## Introduction
t-Test example presented in Tabel 3.1 of the t-Test of difference in average glucose by exercise for the women that are not diabetic. These eamples are to revisit som t-test R estimations 

```{r}
# setwd("~/Dropbox/Fdo/ClaseStats/RegresionClass/RegresionR_code")
# To set the working directory at the user dir
library(tidyverse)
library(multcomp)
hers <- read_csv("~/Dropbox/Fdo/ClaseStats/RegressionClass/RegressionR_code/DataRegressBook/Chap3/hersdata.csv")
# Loading the HERS database in hers varible
summary(hers)
boxplot(glucose ~ diabetes, data=hers)
# For the 
boxplot(glucose[hers$diabetes == "no"] ~ exercise[hers$diabetes == "no"], alternative="two.sided", data=hers)
t.test(glucose[hers$diabetes == "no"] ~ exercise[hers$diabetes == "no"], data=hers, alternative="two.sided", mu=0, paired=FALSE, var.equal=TRUE)
```

## Including Plots

```{r}
summary(hers$diabetes)
ggplot(data = hers, mapping = aes(x = exercise, y = glucose)) + geom_boxplot() + facet_grid( . ~ diabetes)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

# Example from R-bloggers
```{r}
# Create the four groups
set.seed(10) 
df1 <- data.frame(Var="a", Value=rnorm(100,10,5))
df2 <- data.frame(Var="b", Value=rnorm(100,10,5))
df3 <- data.frame(Var="c", Value=rnorm(100,11,6))
df4 <- data.frame(Var="d", Value=rnorm(100,11,6))

# merge them in one data frame
df<-rbind(df1,df2,df3,df4)

# convert Var to a factor
df$Var<-as.factor(df$Var)
df%>%ggplot(aes(x=Value, fill=Var))+geom_density(alpha=0.5)
```
# The ANOVA
The ANOVA model and some examples. The null hypothesis in ANOVA is that there is no difference between means and the alternative is that the means are not all equal. This means that when we are dealing with many groups, we cannot compare them pairwise. We can simply answer if the means between groups can be considered as equal or not.

```{r}
# ANOVA
model1<-lm(Value~Var, data=df)
anova(model1)
```

# Tukey multiple comparisons
What about if we want to compare all the groups pairwise? In this case, we can apply the Tukeyâ€™s HSD which is a single-step multiple comparison procedure and statistical test, Tukey's Honest Significant Difference (Tukey's HSD). It can be used to find means that are significantly different from each other.

```{r}
summary(glht(model1, mcp(Var="Tukey")))
```
